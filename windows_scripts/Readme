üîã Windows Battery Monitor (VBScript)

A lightweight, no-installation battery monitoring tool for Windows.
This VBScript runs in the background using the built-in Windows Script Host and provides:

Smart full-charge notifications

Low-battery warnings

Single-instance protection

Automatic charger detection

Human-friendly status message on startup

Perfect for laptops where you want to prolong battery life by avoiding constant charge to 100%, or get notified before the system shuts down on low battery.

üìå Features
‚úîÔ∏è Smart Full-Charge Detection

The script notifies you to unplug the charger only if:

The charger is connected

Battery percentage is ‚â• 98% (configurable)

OR remaining capacity is ‚â• 98% of rated full capacity

A full-charge notification has not already been shown

‚úîÔ∏è Low-Battery Alerts

You will receive a warning when:

Charger is not connected

Battery percentage is below the threshold (default 20%)

‚úîÔ∏è Initial Status Popup

On launch, the script displays a message that includes:

Current battery percentage

Whether charger is connected

What action to take (if any)

Monitoring interval

‚úîÔ∏è Single-Instance Protection

Ensures only one instance runs at a time.
If another instance is detected, you are asked:

Close the old instance and continue

OR exit the new instance

‚úîÔ∏è Lightweight & No Installation Required

Uses wscript.exe, built into all Windows systems

No admin permissions needed

Minimal RAM and CPU usage (< 4MB, ~0% CPU)

üì• Installation

Download or clone the repository:

git clone https://github.com/<your-username>/battery-monitor-vbs.git


Save the script as:

BatteryMonitor.vbs


Run it:

Double-click the .vbs file, OR

Right-click ‚Üí ‚ÄúRun with Windows Script Host‚Äù

You will see an initial status pop-up showing:

Battery %

Charger status

Recommended action

üñ•Ô∏è How It Appears in Task Manager

The script runs under:

wscript.exe


To view the script's command line:

Open Task Manager ‚Üí Details

Right click ‚Üí Select Columns

Enable Command Line

You will then see something like:

C:\Windows\System32\wscript.exe "C:\Path\BatteryMonitor.vbs"


This allows you to verify the script is running only once.

‚öôÔ∏è Configuration

At the top of the script, you can modify the thresholds:

Const FULL_PERCENT_THRESHOLD = 98     ' Full-charge notification %
Const FULL_RATIO_THRESHOLD   = 0.98   ' Ratio of remaining/full capacity
Const LOW_BATTERY_THRESHOLD  = 20     ' Low battery alert %
Const POLL_INTERVAL_MS       = 60000  ' Check interval (ms)

Examples:

Notify at 95% charge ‚Üí set FULL_PERCENT_THRESHOLD = 95

Poll every 30 seconds ‚Üí set POLL_INTERVAL_MS = 30000

üìö How It Works (Technical Overview)

The script uses Windows WMI classes from the root\wmi namespace:

BatteryFullChargedCapacity

BatteryStatus

It queries:

FullChargedCapacity

RemainingCapacity

Charging (boolean)

From these, it computes:

Battery % = Int((RemainingCapacity / FullChargedCapacity) * 100)


Logic includes:

Anti-duplicate notification flag

Condition-based full-charge reminder

Laptop running-on-battery detection

Safe single-instance handling using Win32_Process


Example placeholders:

‚ùó Limitations

Runs as wscript.exe (cannot rename process in Task Manager)

Requires WMI battery support (some desktops may not report values)

Not a background "service" unless manually added to startup

üèÅ Optional Enhancements (Future Ideas)

If desired, I can help implement:

Tray icon + balloon notifications

EXE version with custom icon

Config file for user settings

Logging to a file

Dark-mode GUI

Auto-start on Windows boot

Battery health estimation

ü§ù Contributing

Pull requests are welcome!
If you want to add new features (icons, tray app, installer, etc.), feel free to open an issue.

üìÑ License

This project is licensed under the MIT License, so anyone can use or modify it freely.

‚≠ê Support

If you find this project useful, consider giving the GitHub repo a ‚≠ê star!
It helps others discover the script and encourages further development.
